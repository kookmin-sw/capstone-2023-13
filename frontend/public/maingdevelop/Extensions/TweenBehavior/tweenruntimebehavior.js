var gdjs;(function(w){function S(o){return o.setScaleX&&o.setScaleY&&o.getScaleX&&o.getScaleY}function y(o){return o.setOpacity&&o.getOpacity}function O(o){return o.setColor&&o.getColor}function F(o){return o.setCharacterSize&&o.getCharacterSize}function T(o,e,t){o/=255,e/=255,t/=255;let n=Math.max(o,e,t),s=n-Math.min(o,e,t),r=1-Math.abs(n+n-s-1),i=s&&(n===o?(e-t)/s:n===e?2+(t-o)/s:4+(o-e)/s);return[Math.round(60*(i<0?i+6:i)),Math.round((r?s/r:0)*100),Math.round((n+n-s)/2*100)]}function v(o,e,t){o=o%=360,o<0&&(o+=360),e=e/100,t=t/100;const n=e*Math.min(t,1-t),s=(r=0,i=(r+o/30)%12)=>t-n*Math.max(Math.min(i-3,9-i,1),-1);return[Math.round(s(0)*255),Math.round(s(8)*255),Math.round(s(4)*255)]}const f=class extends w.RuntimeBehavior{constructor(e,t,n){super(e,t,n);this._tweens={};this._isActive=!0;this._runtimeScene=e.getScene()}updateFromBehaviorData(e,t){return!0}onDestroy(){const e=this._runtimeScene.shiftyJsScene;if(!!e)for(const t in this._tweens)this._tweens[t].instance.stop(),e.remove(this._tweens[t].instance)}_addTween(e,t,n,s,r,i){if(!this._isActive||!!f.easings[t])return;this._tweenExists(e)&&this.removeTween(e);const a=new shifty.Tweenable;this._tweens[e]=new f.TweenInstance(a,!1,s,r),this._runtimeScene.shiftyJsScene||(this._runtimeScene.shiftyJsScene=new shifty.Scene),this._runtimeScene.shiftyJsScene.add(a),a.tween(n).then(()=>{this._tweens[e]&&(this._tweens[e].hasFinished=!0),i&&this.owner.deleteFromScene(this._runtimeScene)}).catch(c=>{})}_tweenExists(e){return!!this._tweens[e]}_tweenIsPlaying(e){return this._tweens[e]&&this._tweens[e].instance.isPlaying()}_pauseTween(e){const t=this._tweens[e];t.instance.pause();const n=this._runtimeScene.shiftyJsScene;n&&n.remove(t.instance)}_resumeTween(e){const t=this._tweens[e];t.instance.resume();const n=this._runtimeScene.shiftyJsScene;n&&n.add(t.instance)}_stopTween(e,t){this._tweens[e].instance.stop(t)}_tweenHasFinished(e){return this._tweens[e].hasFinished}addVariableTween(e,t,n,s,r,i,a){this._addTween(e,r,{from:{value:n},to:{value:s},duration:i,easing:r,render:c=>t.setNumber(c.value)},this._runtimeScene.getTimeManager().getTimeFromStart(),i,a)}addVariableTween2(e,t,n,s,r,i){this._addTween(e,s,{from:{value:t.getValue()},to:{value:n},duration:r,easing:s,render:a=>t.setNumber(a.value)},this._runtimeScene.getTimeManager().getTimeFromStart(),r,i)}addObjectPositionTween(e,t,n,s,r,i){this._addTween(e,s,{from:{x:this.owner.getX(),y:this.owner.getY()},to:{x:t,y:n},duration:r,easing:s,render:a=>{this.owner.setX(a.x),this.owner.setY(a.y)}},this._runtimeScene.getTimeManager().getTimeFromStart(),r,i)}addObjectPositionXTween(e,t,n,s,r){this._addTween(e,n,{from:{x:this.owner.getX()},to:{x:t},duration:s,easing:n,render:i=>this.owner.setX(i.x)},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectPositionYTween(e,t,n,s,r){this._addTween(e,n,{from:{y:this.owner.getY()},to:{y:t},duration:s,easing:n,render:i=>this.owner.setY(i.y)},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectAngleTween(e,t,n,s,r){this._addTween(e,n,{from:{angle:this.owner.getAngle()},to:{angle:t},duration:s,easing:n,render:i=>{this.owner.setAngle(i.angle)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectScaleTween(e,t,n,s,r,i,a){if(!S(this.owner))return;const c=this.owner;t<0&&(t=0),n<0&&(n=0);const h=a?l=>{const m=c.getCenterXInScene(),g=c.getCenterYInScene();c.setScaleX(l.scaleX),c.setScaleY(l.scaleY),c.setCenterPositionInScene(m,g)}:l=>{c.setScaleX(l.scaleX),c.setScaleY(l.scaleY)};this._addTween(e,s,{from:{scaleX:c.getScaleX(),scaleY:c.getScaleY()},to:{scaleX:t,scaleY:n},duration:r,easing:s,render:h},this._runtimeScene.getTimeManager().getTimeFromStart(),r,i)}addObjectScaleXTween(e,t,n,s,r,i){if(!S(this.owner))return;const a=this.owner,c=i?h=>{const l=a.getCenterXInScene();a.setScaleX(h.scaleX),a.setCenterXInScene(l)}:h=>a.setScaleX(h.scaleX);this._addTween(e,n,{from:{scaleX:a.getScaleX()},to:{scaleX:t},duration:s,easing:n,render:c},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectScaleYTween(e,t,n,s,r,i){if(!S(this.owner))return;const a=this.owner,c=i?h=>{const l=a.getCenterYInScene();a.setScaleY(h.scaleY),a.setCenterYInScene(l)}:h=>a.setScaleY(h.scaleY);this._addTween(e,n,{from:{scaleY:a.getScaleY()},to:{scaleY:t},duration:s,easing:n,render:c},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectOpacityTween(e,t,n,s,r){if(!y(this.owner))return;const i=this.owner;this._addTween(e,n,{from:{opacity:i.getOpacity()},to:{opacity:t},duration:s,easing:n,render:a=>{i.setOpacity(a.opacity)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectColorTween(e,t,n,s,r,i){if(!O(this.owner)||!t.match("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]);){2}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"))return;const a=this.owner,c=this.owner.getColor().split(";"),h=t.split(";");if(h.length!==3)return;let l;if(i){const m=T(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])),g=T(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]));l={from:{hue:m[0],saturation:m[1],lightness:m[2]},to:{hue:g[0],saturation:g[1],lightness:g[2]},duration:s,easing:n,render:d=>{const b=v(d.hue,d.saturation,d.lightness);a.setColor(Math.floor(b[0])+";"+Math.floor(b[1])+";"+Math.floor(b[2]))}}}else l={from:{red:c[0],green:c[1],blue:c[2]},to:{red:h[0],green:h[1],blue:h[2]},duration:s,easing:n,render:m=>{a.setColor(Math.floor(m.red)+";"+Math.floor(m.green)+";"+Math.floor(m.blue))}};this._addTween(e,n,l,this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectColorHSLTween(e,t,n,s,r,i,a,c){if(!O(this.owner))return;const h=this.owner,l=h.getColor().split(";");if(l.length<3)return;const m=T(parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])),g=n?t:m[0],d=s===-1?m[1]:Math.min(Math.max(s,0),100),b=r===-1?m[2]:Math.min(Math.max(r,0),100);this._addTween(e,i,{from:{hue:m[0],saturation:m[1],lightness:m[2]},to:{hue:g,saturation:d,lightness:b},duration:a,easing:i,render:_=>{const p=v(_.hue,_.saturation,_.lightness);h.setColor(Math.floor(p[0])+";"+Math.floor(p[1])+";"+Math.floor(p[2]))}},this._runtimeScene.getTimeManager().getTimeFromStart(),a,c)}addTextObjectCharacterSizeTween(e,t,n,s,r){if(!F(this.owner))return;const i=this.owner;this._addTween(e,n,{from:{size:i.getCharacterSize()},to:{size:t},duration:s,easing:n,render:function(c){i.setCharacterSize(c.size)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectWidthTween(e,t,n,s,r){this._addTween(e,n,{from:{width:this.owner.getWidth()},to:{width:t},duration:s,easing:n,render:i=>{this.owner.setWidth(i.width)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}addObjectHeightTween(e,t,n,s,r){this._addTween(e,n,{from:{height:this.owner.getHeight()},to:{height:t},duration:s,easing:n,render:i=>{this.owner.setHeight(i.height)}},this._runtimeScene.getTimeManager().getTimeFromStart(),s,r)}isPlaying(e){return this._tweenExists(e)&&this._tweenIsPlaying(e)}exists(e){return this._tweenExists(e)}hasFinished(e){return this._tweenExists(e)&&this._tweenHasFinished(e)}pauseTween(e){this._isActive&&this._tweenExists(e)&&this._tweenIsPlaying(e)&&this._pauseTween(e)}stopTween(e,t){this._isActive&&this._tweenExists(e)&&this._tweenIsPlaying(e)&&this._stopTween(e,t)}resumeTween(e){this._isActive&&this._tweenExists(e)&&!this._tweenIsPlaying(e)&&this._resumeTween(e)}removeTween(e){!this._tweenExists(e)||(this._tweens[e].instance.stop(),this._runtimeScene.shiftyJsScene&&this._runtimeScene.shiftyJsScene.remove(this._tweens[e].instance),delete this._tweens[e])}getProgress(e){const t=this._tweens[e];if(t){const n=this._runtimeScene.getTimeManager().getTimeFromStart();return n>=t.startTime+t.totalDuration?1:(n-t.startTime)/t.totalDuration}else return 0}onDeActivate(){if(!!this._isActive){for(const e in this._tweens)if(this._tweens.hasOwnProperty(e)){const t=this._tweens[e];t.instance.isPlaying()&&(t.resumeOnActivate=!0,this._pauseTween(e))}this._isActive=!1}}onActivate(){if(!this._isActive){for(const e in this._tweens)if(this._tweens.hasOwnProperty(e)){const t=this._tweens[e];t.resumeOnActivate&&(t.resumeOnActivate=!1,this._resumeTween(e))}this._isActive=!0}}};let u=f;u.easings=["linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeOutBounce","easeInBack","easeOutBack","easeInOutBack","elastic","swingFromTo","swingFrom","swingTo","bounce","bouncePast","easeFromTo","easeFrom","easeTo"],u._currentTweenTime=0,w.TweenRuntimeBehavior=u,w.registerBehavior("Tween::TweenBehavior",w.TweenRuntimeBehavior),function(e){class o{constructor(n,s,r,i){this.resumeOnActivate=!1;this.instance=n,this.hasFinished=s,this.startTime=r,this.totalDuration=i}}e.TweenInstance=o}(u=w.TweenRuntimeBehavior||(w.TweenRuntimeBehavior={}))})(gdjs||(gdjs={}));
//# sourceMappingURL=tweenruntimebehavior.js.map
